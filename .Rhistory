name_realce_od <- c("realce_retrobulbar_od",
"realce_porcao_media_od",
"realce_posterior_od",
"realce_sem_alt_od")
df_realce_od <- split_mcv("local_realce_od","4",mridata)
df_realce_od <- mutate_mcv(name_realce_od, df_realce_od)
mridata <- mridata[, names(mridata) != "local_realce_od"]
mridata <- cbind(mridata, df_realce_od)
name_alt <- c("hipersinal_quiasma",
"hipersinal_mais_2/3",
"realce_quiasma",
"realce_mais_2/3",
"realce_perineural",
"nenhuma_das_alt_acima")
name_alt <- c("hipersinal_quiasma",
"hipersinal_mais_2/3",
"realce_quiasma",
"realce_mais_2/3",
"realce_perineural",
"nenhuma_das_alt_acima")
df_genalt <- split_mcv("alteracoes_orbita","6", mridata)
View(df_genalt)
## Correct inconsistencies
df_genalt[df_genalt == 7]
df_genalt[df_genalt == 7] <- 5
df_genalt[df_genalt == 9] <- 6
View(df_genalt)
## Continue
df_genalt <- mutate_mcv(name_alt, df_genalt)
View(df_genalt)
mridata <- mridata[, names(mridata) != "alteracoes_orbita"]
mridata <- cbind(mridata, df_genalt)
View(mridata)
orbit_dataset <- mridata
devtools::load_all(".")
library(emocempr)
orbitdata <- clean_orbit.R("C:/Users/Rafael/Documents/MRI_orbit_EMOCEMP_V1_May 28, 2020_14.37.csv")
View(orbitdata)
install.packages("irr")
orbit <- clean_orbit.R("C:/Users/Rafael/Documents/MRI_orbit_EMOCEMP_V1_May 28, 2020_14.37.csv")
library(dplyr)
View(orbit)
testdata <- orbit %>%
select(id_participante,avaliador,lesoes_no)
testdata
testdata_BKC <- orbit %>%
select(id_participante,avaliador,lesoes_no) %>%
filter(avaliador == "BKC")
View(testdata_BKC)
testdata2_RP <- orbit %>%
select(id_participante,avaliador,lesoes_no) %>%
filter(avaliador == "RP")
testdata_BKC <- orbit %>%
mutate(bkc = lesoes_no)
select(id_participante,avaliador,bkc) %>%
filter(avaliador == "BKC")
View(testdata_BKC)
View(testdata)
orbit <- clean_orbit.R("C:/Users/Rafael/Documents/MRI_orbit_EMOCEMP_V1_May 28, 2020_14.37.csv")
testdata_BKC <- orbit %>%
mutate(bkc = lesoes_no)
orbit <- clean_orbit.R("C:/Users/Rafael/Documents/MRI_orbit_EMOCEMP_V1_May 28, 2020_14.37.csv")
testdata_BKC <- orbit %>%
mutate(bkc = lesoes_no) %>%
select(id_participante,avaliador,bkc) %>%
filter(avaliador == "BKC")
View(testdata_BKC)
testdata_BKC <- orbit %>%
mutate(bkc = factor(lesoes_no)) %>%
select(id_participante,avaliador,bkc) %>%
filter(avaliador == "BKC")
levels(testdata_BKC)
levels(testdata_BKC$bkc)
testdata_RP <- orbit %>%
mutate(bkc = factor(lesoes_no)) %>%
select(id_participante,avaliador,bkc) %>%
filter(avaliador == "RP")
merge(testdata_BKC,testdata_RP,by = id_participante)
merge(testdata_BKC,testdata_RP,by = "id_participante")
library(irr)
data4kappa <- merge(testdata_BKC,testdata_RP,by = "id_participante")
View(data4kappa)
testdata_BKC <- orbit %>%
mutate(bkc = factor(lesoes_no)) %>%
select(id_participante,avaliador,bkc) %>%
filter(avaliador == "BKC")
testdata_RP <- orbit %>%
mutate(bkc = factor(lesoes_no)) %>%
select(id_participante,avaliador,rp) %>%
filter(avaliador == "RP")
data4kappa <- merge(testdata_BKC,testdata_RP,by = "id_participante")
testdata_BKC <- orbit %>%
mutate(bkc = factor(lesoes_no)) %>%
select(id_participante,avaliador,bkc) %>%
filter(avaliador == "BKC")
testdata_RP <- orbit %>%
mutate(rp = factor(lesoes_no)) %>%
select(id_participante,avaliador,rp) %>%
filter(avaliador == "RP")
data4kappa <- merge(testdata_BKC,testdata_RP,by = "id_participante")
kappa2(data4kappa$bkc,data4kappa$rp)
?kappa2
data4kappa <- select(data4kappa, bkc, rp)
View(data4kappa)
kappa2(data4kappa)
agree(data4kappa,tolerance = 0)
is.vector("lesoes_no")
result <- kappa2(data4kappa)
View(result)
varnames <- c("one","two","three","four")
for (i in varnames){
print i
}
for (i in varnames){
print varnames[i]
}
for (i in varnames){
print(varnames[i])
}
for (i in varnames){
print(i)
}
datafile <- clean_orbit.R("C:/Users/Rafael/Documents/MRI_orbit_EMOCEMP_V1_May 28, 2020_14.37.csv")
View(datafile)
colnames(datafile)
varnames <- c("sem_alt_oe","retrobulbar_oe","lesoes_no")
list_k <- list()
for (i in varnames){
testdata_BKC <- datafile %>%
mutate(bkc = factor(datafile[[i]])) %>%
select(id_participante,avaliador,bkc) %>%
filter(avaliador == "BKC")
testdata_RP <- datafile %>%
mutate(rp = factor(i)) %>%
select(id_participante,avaliador,rp) %>%
filter(avaliador == "RP")
#-----------------------------------------------------------------#
data4kappa <- merge(testdata_BKC,testdata_RP,by = "id_participante")
data4kappa <- select(data4kappa, bkc, rp)
#-----------------------------------------------------------------#
list_k[[i]] <- kappa2(data4kappa)
}
View(list_k)
list_k
View(data4kappa)
list_k <- list()
for (i in varnames){
testdata_BKC <- datafile %>%
mutate(bkc = factor(datafile[[i]])) %>%
select(id_participante,avaliador,bkc) %>%
filter(avaliador == "BKC")
testdata_RP <- datafile %>%
mutate(rp = datafile[[i]]) %>%
select(id_participante,avaliador,rp) %>%
filter(avaliador == "RP")
#-----------------------------------------------------------------#
data4kappa <- merge(testdata_BKC,testdata_RP,by = "id_participante")
data4kappa <- select(data4kappa, bkc, rp)
#-----------------------------------------------------------------#
list_k[[i]] <- kappa2(data4kappa)
}
list_k
str(list_k)
v3 <- "C:/Users/Rafael/Documents/EMOCEMP V3 - Oficial_May 29, 2020_10.18.csv"
emocemp_messy <- read.csv(v3,
skip = 1,
encoding = "UTF-8",
stringsAsFactors = FALSE)
# Exclude irrelevant rows and collumns from table
emocempv3 <- emocemp_messy[-c(1),-c(1:17)]
emocempv3 <- emocempv3[,-79]
View(emocempv3)
colnames(emocempv3)
colnames(emocempv3) <- c("data_visita",
"id_centro",
"id_paciente",
"peso",
"altura",
"imc",
"tabagismo",
"sf_piramidal",
"sf_cerebelar",
"sf_sensitivo",
"sf_tronco",
"sf_visual",
"sf_vesical_intestinal",
"sf_cerebral",
"conv_sf_visual",
"conv_sf_vesical_intestinal",
"deambula",
"edss",
"data_cerebro_rm_v2",
"data_orbitas_rm_v2",
"data_medula_rm_v2",
"rm_encefalo",
"rm_encefalo_realce",
"rm_encefalo_coment",
"rm_orbita",
"rm_orbita_realce_text",
"rm_medula",
"rm_medula_realce_text",
"rm_medula_coment",
"rm_outros_texto",
"medicacoes_cont",
"criterio_diag_v2",
"criterio_diag_outros_v2_text",
"fan_titulo_padrao",
"fr",
"vhs",
"anti-ssa",
"anti-ssb",
"vit_d",
"vit_b12",
"outros_labs",
"dmd_v2",
"ifn_b1a_im_dose",
"ifn_b1a_sc22_dose",
"ifn_b1a_sc44_dose",
"ifn_b1b_dose",
"acetato_glati_dose",
"teriflunomida_dose",
"fumarato_dose",
"fingolimod_dose",
"natalizumba_dose",
"alentuzumab_dose",
"rituximab_dose",
"azatioprina_dose",
"outros_dose",
"efeitos_adversos",
"efeitos_adversos_texto",
"observacoes",
"novo_surto_v2",
"novas_sindromes_clinicas",
"nob_data",
"nou_data",
"mielite_p_data",
"mielite_t_data",
"adem_data",
"romboencefalite_data",
"outras_data",
"lcr_cel",
"lcr_dif",
"lcr_prot",
"lcr_boc",
"lcr_igg_i",
"tto_fa_v2",
"mpiv_dose",
"corticoide_vo_dose",
"igiv_dose",
"plex_dose")
View(emocempv3)
colnames(emocempv3) <- c("data_visita",
"id_centro",
"id_paciente",
"peso",
"altura",
"imc",
"tabagismo",
"sf_piramidal",
"sf_cerebelar",
"sf_sensitivo",
"sf_tronco",
"sf_visual",
"sf_vesical_intestinal",
"sf_cerebral",
"conv_sf_visual",
"conv_sf_vesical_intestinal",
"deambula",
"edss",
"data_cerebro_rm_v3",
"data_orbitas_rm_v3",
"data_medula_rm_v3",
"rm_encefalo",
"rm_encefalo_realce",
"rm_encefalo_coment",
"rm_orbita",
"rm_orbita_realce_text",
"rm_medula",
"rm_medula_realce_text",
"rm_medula_coment",
"rm_outros_texto",
"medicacoes_cont",
"criterio_diag_v3",
"criterio_diag_outros_v3_text",
"fan_titulo_padrao",
"fr",
"vhs",
"anti-ssa",
"anti-ssb",
"vit_d",
"vit_b12",
"outros_labs",
"dmd_v2",
"ifn_b1a_im_dose",
"ifn_b1a_sc22_dose",
"ifn_b1a_sc44_dose",
"ifn_b1b_dose",
"acetato_glati_dose",
"teriflunomida_dose",
"fumarato_dose",
"fingolimod_dose",
"natalizumba_dose",
"alentuzumab_dose",
"rituximab_dose",
"azatioprina_dose",
"outros_dose",
"efeitos_adversos",
"efeitos_adversos_texto",
"observacoes",
"novo_surto_v3",
"novas_sindromes_clinicas",
"nob_data",
"nou_data",
"mielite_p_data",
"mielite_t_data",
"adem_data",
"romboencefalite_data",
"outras_data",
"lcr_cel",
"lcr_dif",
"lcr_prot",
"lcr_boc",
"lcr_igg_i",
"tto_fa_v3",
"mpiv_dose",
"corticoide_vo_dose",
"igiv_dose",
"plex_dose")
v3 <- "C:/Users/Rafael/Documents/EMOCEMP V3 - Oficial_May 29, 2020_10.18.csv"
emocemp_messy <- read.csv(v3,
skip = 1,
encoding = "UTF-8",
stringsAsFactors = FALSE)
# Exclude irrelevant rows and collumns from table
emocempv3 <- emocemp_messy[-c(1),-c(1:17)]
emocempv3 <- emocempv3[,-79]
colnames(emocempv3) <- c("data_visita",
"id_centro",
"id_paciente",
"peso",
"altura",
"imc",
"tabagismo",
"sf_piramidal",
"sf_cerebelar",
"sf_sensitivo",
"sf_tronco",
"sf_visual",
"sf_vesical_intestinal",
"sf_cerebral",
"conv_sf_visual",
"conv_sf_vesical_intestinal",
"deambula",
"edss",
"data_cerebro_rm_v3",
"data_orbitas_rm_v3",
"data_medula_rm_v3",
"rm_encefalo",
"rm_encefalo_realce",
"rm_encefalo_coment",
"rm_orbita",
"rm_orbita_realce_text",
"rm_medula",
"rm_medula_realce_text",
"rm_medula_coment",
"rm_outros_texto",
"medicacoes_cont",
"criterio_diag_v3",
"criterio_diag_outros_v3_text",
"fan_titulo_padrao",
"fr",
"vhs",
"anti-ssa",
"anti-ssb",
"vit_d",
"vit_b12",
"outros_labs",
"dmd_v2",
"ifn_b1a_im_dose",
"ifn_b1a_sc22_dose",
"ifn_b1a_sc44_dose",
"ifn_b1b_dose",
"acetato_glati_dose",
"teriflunomida_dose",
"fumarato_dose",
"fingolimod_dose",
"natalizumba_dose",
"alentuzumab_dose",
"rituximab_dose",
"azatioprina_dose",
"outros_dose",
"efeitos_adversos",
"efeitos_adversos_texto",
"observacoes",
"novo_surto_v3",
"novas_sindromes_clinicas",
"nob_data",
"nou_data",
"mielite_p_data",
"mielite_t_data",
"adem_data",
"romboencefalite_data",
"outras_data",
"lcr_cel",
"lcr_dif",
"lcr_prot",
"lcr_boc",
"lcr_igg_i",
"tto_fa_v3",
"mpiv_dose",
"corticoide_vo_dose",
"igiv_dose",
"plex_dose")
name_clinical <- c("neurite_b",
"neurite_u",
"mielite_p",
"mielite_t",
"adem" ,
"romboencefalite",
"outras",
"nenhumas_das_sindromes")
clinical_df <- split_mcv("novas_sindromes_clinicas","8",emocempv3)
split_mcv <- function (var,n,dataf) {
charc <- as.character(dataf[[var]])
split <- str_split_fixed(charc, ",", n)
df <- as.data.frame(split)
# Change to numeric
ncol = as.numeric(n)
for (i in 1:n){
df[,i] <- as.numeric(df[,i])
df[,i]
df[,i][is.na(df[,i])] <- 0
}
return(df)
}
clinical_df <- split_mcv("novas_sindromes_clinicas","8",emocempv3)
library(stringr)
clinical_df <- split_mcv("novas_sindromes_clinicas","8",emocempv3)
View(clinical_df)
clinical_df <- mutate_mcv(name_clinical,clinical_df)
mutate_mcv <- function (names, df){
# Aceita uma lista de strings (names) e um data.frame resultante de split.mcv
# Tests
if (length(names) != ncol(df) ){
print("Names e colunas do Data Frame com tamanhos diferentes")
break
}
if (!is.data.frame(df)){
print("df precisa ser um Data Frame")
break
}
# Create empty data.frame
new_df <- NULL
# Loop variables
for (i in 1:length(names)) {
vec <- c()
# Loop trought rows
for (r in 1:nrow(df)) {
vec[r] <- any(df[r,] == i )}
# Bind logical vector to new_df and name column
vec <- as.numeric(vec)
new_df <- cbind(vec, new_df)
colnames(new_df)[1] <- names[i]
}
return(new_df)
}
clinical_df <- mutate_mcv(name_clinical,clinical_df)
View(clinical_df)
clinical_df <- split_mcv("novas_sindromes_clinicas","8",emocempv3)
clinical_df <- split_mcv("novas_sindromes_clinicas","8",emocempv3)
clinical_df <- mutate_mcv(name_clinical,clinical_df)
emocempv3 <- emocempv3[, names(emocempv3) != "novas_sindromes_clinicas"]
emocempv3 <- cbind(emocempv3, clinical_df)
name_brm <- c("1_lesao_perpendicular_cc_brm",
"apenas_bem_delimitadas_brm",
"5_ou_mais_t2_brm",
"2_ou_mais_peri_brm",
"1_ou_mais_tronco_brm" ,
"black_holes_brm",
"lesoes_difusas_bilat_brm",
"1_ou_mais_justa_brm",
"1_ou_mais_peri_brm",
"1_ou_mais_infra_brm",
"outros_realce_brm",
"nenhuma_das_alt_brm",
"nao_realizada_brm",
"outras_brm",
"realce_anel_inc_brm")
brm_df <- split_mcv("rm_encefalo","15",emocempv3)
View(brm_df)
brm_df <- split_mcv("rm_encefalo","15",emocempv3)
brm_df <- mutate_mcv(name_brm,brm_df)
emocempv3 <- emocempv3[, names(emocempv3) != "rm_encefalo"]
emocempv3 <- cbind(emocempv3, brm_df)
name_srm <- c("mielite_t_srm",
"mielite_centromed_srm",
"mielite_perif_srm",
"mielite_menos_3seg_srm",
"mielite_mais_3seg_srm" ,
"mielite_cerv_srm",
"mielite_dors_srm",
"mielite_lombo_srm",
"nenhuma_das_acima_srm",
"nao_realizada_srm",
"realce_srm",
"brigth_spot_srm",
"outras_srm")
srm_df <- split_mcv("rm_medula","13",emocempv3)
srm_df <- mutate_mcv(name_srm,srm_df)
emocempv3 <- emocempv3[, names(emocempv3) != "rm_medula"]
emocempv3 <- cbind(emocempv3, srm_df)
View(emocempv3)
